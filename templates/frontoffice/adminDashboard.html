<!DOCTYPE html>
<html lang="FR">

<head>
<!-- NOTE: Cleaned up dependencies; ensure jQuery loads from local static/js -->
<meta charset="UTF-8">
<title>Admin Dashboard</title>
{% load static %}
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel='stylesheet' href="{% static 'vendor/bootstrap-4.1/bootstrap.min.css' %}">

<link rel='stylesheet' href="{% static 'vendor/font-awesome-5/css/fontawesome-all.min.css' %}">
<link href="{% static 'vendor/mdi-font/css/material-design-iconic-font.min.css' %}"
	rel="stylesheet" media="all">
<link href="{% static 'vendor/datatable/dataTables.bootstrap4.min.css' %}"
	rel="stylesheet" media="all">

<link rel="stylesheet" href ="{% static 'style/style.css' %}">
<link rel="stylesheet" href ="{% static 'style/theme.css' %}">
<link href="{% static 'vendor/css-hamburgers/hamburgers.min.css' %}" rel="stylesheet"
	media="all">

<link rel="stylesheet" href="{% static 'style/main.css' %}">
<link rel="stylesheet" href="{% static 'style/sidebar-improvements.css' %}">

<style>
/* Force sidebar dropdown styles */
.sidebar-dropdown > a.dropdown-toggle {
  display: flex !important;
  align-items: center;
  gap: 12px;
  padding: 10px 12px;
  border-radius: 8px;
  color: #e5e7eb;
  text-decoration: none;
  transition: background .2s ease;
  cursor: pointer;
  position: relative;
}

.sidebar-dropdown > a.dropdown-toggle i.arrow {
  margin-left: auto;
  font-size: 10px;
  transition: transform .25s ease;
}

.sidebar-dropdown.active > a.dropdown-toggle i.arrow {
  transform: rotate(-180deg);
}

.sidebar-dropdown > a.dropdown-toggle:hover {
  background: rgba(59,130,246,.15);
  color: #fff;
}

.sidebar-submenu {
  list-style: none;
  margin: 0;
  padding: 0;
  max-height: 0;
  overflow: hidden;
  transition: max-height .3s ease;
  background: rgba(0,0,0,.15);
  border-radius: 8px;
  margin-top: 4px;
}

.sidebar-dropdown.active .sidebar-submenu {
  max-height: 500px !important;
  padding: 6px 0 !important;
}

.sidebar-submenu li {
  margin: 0;
}

.sidebar-submenu li a {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 12px 8px 40px;
  color: #9ca3af;
  text-decoration: none;
  font-size: 13px;
  transition: all .2s ease;
  border-radius: 6px;
  margin: 0 6px;
}

.sidebar-submenu li a:hover {
  background: rgba(59,130,246,.15);
  color: #e5e7eb;
  padding-left: 44px;
}

.sidebar-submenu li a i {
  width: 16px;
  text-align: center;
  font-size: 12px;
}

.sidebar-submenu li a:hover i {
  color: #3b82f6;
}
</style>

<script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
<script src="{% static 'vendor/bootstrap-4.1/popper.min.js' %}"></script>
<script src="{% static 'vendor/bootstrap-4.1/bootstrap.min.js' %}"></script>
<script src="{% static 'vendor/datatable/jquery.dataTables.min.js' %}"
	type="text/javascript"></script>
<script src="{% static 'vendor/datatable/dataTables.bootstrap4.min.js' %}"
	type="text/javascript"></script>
<script src="{% static 'vendor/chartjs/Chart.min.js' %}"></script>

</head>
<body>
	<div class="page-wrapper chiller-theme toggled">
		<a id="show-sidebar" class="btn btn-sm btn-dark" href="#"> <i
			class="fas fa-bars"></i>
		</a>
		<nav id="sidebar" class="sidebar-wrapper">
			<div class="sidebar-content">
				<div class="sidebar-brand">
					<a href="#" class="h2 pt-2">Market</a>
					<div id="close-sidebar">
						<i class="fas fa-times"></i>
					</div>
				</div>
				<div class="sidebar-header">
					<div class="user-pic">
						<img class="img-responsive img-rounded" src="{% static 'img/no-photo.png' %}"
							alt="User picture">
					</div>
					<div class="user-info">
						<span class="user-name"><strong>NOM</strong></span>
						<span class="user-role">ROLE</span>
					</div>
				</div>

				<div class="sidebar-menu">
					<ul>
						<li class="header-menu"><span>CATALOGUE</span></li>
						<li class="sidebar-dropdown">
							<a href="#" class="dropdown-toggle">
								<i class="fas fa-box"></i>
								<span>Produits</span>
								<i class="fas fa-chevron-down arrow"></i>
							</a>
							<ul class="sidebar-submenu">
								<li>
									<a href="{%  url 'produits' %}">
										<i class="fas fa-list"></i>Liste des produits
									</a>
								</li>
								<li>
									<a href="./adminDashboard.html" onclick="show('categorie')">
										<i class="fas fa-tags"></i>Catégories
									</a>
								</li>
								<li>
									<a href="./adminDashboard.html" onclick="show('marque')">
										<i class="fas fa-copyright"></i>Marques
									</a>
								</li>
							</ul>
						</li>

						<li class="header-menu"><span>INFRASTRUCTURE</span></li>
						<li class="sidebar-dropdown">
							<a href="#" class="dropdown-toggle">
								<i class="fas fa-building"></i>
								<span>Locaux</span>
								<i class="fas fa-chevron-down arrow"></i>
							</a>
							<ul class="sidebar-submenu">
								<li>
									<a href="./adminDashboard.html" onclick="show('salle')">
										<i class="fas fa-door-open"></i>Salles
									</a>
								</li>
								<li>
									<a href="./adminDashboard.html" onclick="show('machine')">
										<i class="fas fa-cogs"></i>Machines
									</a>
								</li>
							</ul>
						</li>

						<li class="header-menu"><span>RAPPORTS</span></li>
						<li>
							<a href="./adminDashboard.html" onclick="show('statistiques')">
								<i class="fas fa-chart-line"></i>Statistiques
							</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="sidebar-footer">
				<a href="/logout/" class="logout-link">
					<i class="fa fa-power-off"></i>
					<span>Déconnexion</span>
				</a>
			</div>
		</nav>
		<!-- sidebar-wrapper  -->



                    {% block content %}
                    {% endblock %}


		</div>
		</main>
		<!-- page-content" -->
    	</div>


</body>

	<!-- page-wrapper-->
<script src="{% static 'script/redirect.js' %}"></script>
	<script src="{% static 'vendor/slick/slick.min.js' %}">

	</script>
	<script src="{% static 'vendor/wow/wow.min.js' %}"></script>
	<script src="{% static 'vendor/animsition/animsition.min.js' %}"></script>
	<script src="{% static 'vendor/bootstrap-progressbar/bootstrap-progressbar.min.js' %}">

	</script>
	<script src="{% static 'vendor/counter-up/jquery.waypoints.min.js' %}"></script>
	<script src="{% static 'vendor/counter-up/jquery.counterup.min.js' %}">

	</script>
	<script src="{% static 'vendor/circle-progress/circle-progress.min.js' %}"></script>
	<script src="{% static 'vendor/perfect-scrollbar/perfect-scrollbar.js' %}"></script>
	<script src="{% static 'vendor/chartjs/Chart.bundle.min.js' %}"></script>
	<script src="{% static 'vendor/select2/select2.min.js' %}">

	</script>
	<script src="{% static 'script/index.js' %}"></script>
	<script src="{% static 'script/statistiques.js' %}"></script>
	<script src="{% static 'script/sidebar-dropdown.js' %}"></script>
	<script src="{% static 'js/main.js' %}"></script>

	<script>
	// Force initialization of sidebar dropdowns
	jQuery(document).ready(function($) {
		console.log('[Sidebar] jQuery ready - initializing dropdowns');

		// Click handler for dropdown toggles
		$('.sidebar-dropdown > .dropdown-toggle').on('click', function(e) {
			e.preventDefault();
			e.stopPropagation();

			console.log('[Sidebar] Dropdown clicked');

			var $parent = $(this).parent('.sidebar-dropdown');
			var isActive = $parent.hasClass('active');

			// Close all other dropdowns
			$('.sidebar-dropdown.active').removeClass('active');

			// Toggle current dropdown
			if (!isActive) {
				$parent.addClass('active');
				console.log('[Sidebar] Opened dropdown');
			} else {
				console.log('[Sidebar] Closed dropdown');
			}

			return false;
		});

		console.log('[Sidebar] Found ' + $('.sidebar-dropdown').length + ' dropdowns');
		console.log('[Sidebar] Initialization complete');
	});
	</script>
</html>

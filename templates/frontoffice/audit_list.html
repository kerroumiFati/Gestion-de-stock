{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Journaux d'audit</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
  <div class="container-fluid">
    <h1>Journaux d'audit</h1>
    <p>Dernières 500 actions. Endpoint API: /API/audit-logs/ (staff requis)</p>
    <table class="table table-sm table-striped table-bordered">
      <thead class="thead-light">
        <tr>
          <th>Date</th>
          <th>Acteur</th>
          <th>Action</th>
          <th>Cible</th>
          <th>Détails</th>
          <th>IP</th>
          <th>User-Agent</th>
        </tr>
      </thead>
      <tbody>
        {% for log in logs %}
        <tr>
          <td>{{ log.created_at }}</td>
          <td>{% if log.actor %}{{ log.actor.username }}{% else %}-{% endif %}</td>
          <td><code>{{ log.action }}</code></td>
          <td>{{ log.target_model }} #{{ log.target_id }}<br><small>{{ log.target_repr }}</small></td>
          <td><pre class="mb-0" style="white-space: pre-wrap;">{{ log.metadata }}</pre></td>
          <td>{{ log.ip_address }}</td>
          <td><small>{{ log.user_agent }}</small></td>
        </tr>
        {% empty %}
        <tr><td colspan="7" class="text-center">Aucun log</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</body>
</html>
